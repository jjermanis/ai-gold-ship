<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>競馬</title>

<style>
body {
    margin: 0;
    background: #1b5e20;
    font-family: "Hiragino Kaku Gothic Pro", "Yu Gothic", sans-serif;
    color: white;
}

h1 {
    text-align: center;
    margin: 10px 0;
    font-size: 38px;
    letter-spacing: 4px;
}

#track {
    position: relative;
    height: 460px;
    background: linear-gradient(#2e7d32, #1b5e20);
    border-top: 10px solid #c8e6c9;
    border-bottom: 10px solid #c8e6c9;
    overflow: hidden;
}

/* Finish line */
#finish {
    position: absolute;
    left: 80px;
    top: 0;
    width: 14px;
    height: 100%;
    background: repeating-linear-gradient(
        to bottom,
        white 0px,
        white 12px,
        black 12px,
        black 24px
    );
}

/* Horse container */
.horse {
    position: absolute;
    right: 240px;
    height: 70px;
    width: 160px;
}

/* Horse body */
.body {
    position: absolute;
    width: 90px;
    height: 36px;
    border-radius: 18px;
    top: 20px;
}

.neck {
    position: absolute;
    width: 26px;
    height: 18px;
    left: 70px;
    top: 10px;
    border-radius: 10px;
}

.head {
    position: absolute;
    width: 26px;
    height: 20px;
    left: 90px;
    top: 6px;
    border-radius: 10px;
}

.fringe {
    position: absolute;
    width: 22px;
    height: 10px;
    top: -6px;
    left: 6px;
    border-radius: 8px;
}

/* Legs */
.leg {
    position: absolute;
    width: 6px;
    height: 24px;
    background: #333;
    bottom: 0;
}
.leg.l1 { left: 12px; }
.leg.l2 { left: 30px; }
.leg.l3 { left: 58px; }
.leg.l4 { left: 76px; }

/* Fixed name labels */
.name {
    position: absolute;
    right: 40px;
    width: 180px;
    font-size: 18px;
}

/* Colors */
.p1 .body, .p1 .neck, .p1 .head { background: #e6c8a0; }
.p1 .fringe { background: #3e2723; }

.p2 .body, .p2 .neck, .p2 .head { background: #4e342e; }
.p2 .fringe { background: white; }

.gold .body, .gold .neck, .gold .head { background: #dcdcdc; }
.gold .fringe { background: #9e9e9e; }

.safe .body, .safe .neck, .safe .head { background: #6d4c41; }
.safe .fringe { background: #3e2723; }

/* Start button */
#startBtn {
    position: fixed;
    bottom: 18px;
    left: 50%;
    transform: translateX(-50%);
    background: #ffeb3b;
    border: none;
    border-radius: 10px;
    padding: 14px 34px;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
}
#startBtn:hover {
    background: #fdd835;
}

#info {
    text-align: center;
    margin: 6px;
    font-size: 16px;
}
</style>
</head>

<body>

<h1>競馬</h1>

<div id="info">
プレイヤー1：Q ↑ / A ↓　｜　プレイヤー2：O ↑ / L ↓
</div>

<div id="track">
    <div id="finish"></div>

    <div class="horse p1" style="top:40px">
        <div class="body"><div class="fringe"></div>
            <div class="leg l1"></div><div class="leg l2"></div>
            <div class="leg l3"></div><div class="leg l4"></div>
        </div>
        <div class="neck"></div><div class="head"></div>
    </div>
    <div class="name" style="top:55px">プレイヤー1</div>

    <div class="horse p2" style="top:140px">
        <div class="body"><div class="fringe"></div>
            <div class="leg l1"></div><div class="leg l2"></div>
            <div class="leg l3"></div><div class="leg l4"></div>
        </div>
        <div class="neck"></div><div class="head"></div>
    </div>
    <div class="name" style="top:155px">プレイヤー2</div>

    <div class="horse gold" style="top:240px">
        <div class="body"><div class="fringe"></div>
            <div class="leg l1"></div><div class="leg l2"></div>
            <div class="leg l3"></div><div class="leg l4"></div>
        </div>
        <div class="neck"></div><div class="head"></div>
    </div>
    <div class="name" style="top:255px">ゴールドシップ</div>

    <div class="horse safe" style="top:340px">
        <div class="body"><div class="fringe"></div>
            <div class="leg l1"></div><div class="leg l2"></div>
            <div class="leg l3"></div><div class="leg l4"></div>
        </div>
        <div class="neck"></div><div class="head"></div>
    </div>
    <div class="name" style="top:355px">安全走</div>
</div>

<button id="startBtn" onclick="startRace()">レース開始</button>

<script>
const horses = document.querySelectorAll(".horse");
const names = document.querySelectorAll(".name");

const speeds = [
    { target: 5, current: 0 },
    { target: 5, current: 0 },
    { target: 5, current: 0 },
    { target: 5, current: 0 }
];

let racing = false;

function speak(text) {
    const u = new SpeechSynthesisUtterance(text);
    u.lang = "ja-JP";
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
}

document.addEventListener("keydown", e => {
    if (e.key === "q") speeds[0].target++;
    if (e.key === "a") speeds[0].target--;
    if (e.key === "o") speeds[1].target++;
    if (e.key === "l") speeds[1].target--;
});

function startRace() {
    if (racing) return;
    racing = true;

    horses.forEach(h => h.style.right = "240px");
    speeds.forEach(s => s.current = 2.5); // visible initial kick

    speak("レース開始");

    requestAnimationFrame(loop);
}

function loop() {
    if (!racing) return;

    horses.forEach((horse, i) => {
        const s = speeds[i];
        s.current += (s.target - s.current) * 0.15; // faster acceleration

        let pos = parseFloat(horse.style.right);
        pos += s.current;
        horse.style.right = pos + "px";

        if (pos > window.innerWidth - 220) {
            racing = false;
            speak(names[i].innerText + " が 勝ちました");
        }
    });

    requestAnimationFrame(loop);
}
</script>

</body>
</html>
