<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>競馬</title>

<style>
    body {
        margin: 0;
        background: #1b5e20;
        font-family: "Hiragino Kaku Gothic Pro", "Yu Gothic", sans-serif;
        color: white;
        text-align: center;
    }

    h1 {
        margin: 12px 0;
        font-size: 38px;
        letter-spacing: 4px;
    }

    #track {
        position: relative;
        width: 100%;
        height: 440px;
        background: linear-gradient(#2e7d32, #1b5e20);
        border-top: 10px solid #c8e6c9;
        border-bottom: 10px solid #c8e6c9;
        overflow: hidden;
    }

    /* Finish line (left side) */
    #finish {
        position: absolute;
        left: 90px;
        top: 0;
        width: 14px;
        height: 100%;
        background: repeating-linear-gradient(
            to bottom,
            #ffffff 0px,
            #ffffff 12px,
            #000000 12px,
            #000000 24px
        );
    }

    .horse {
        position: absolute;
        right: 40px;
        width: 240px;
        height: 70px;
        display: flex;
        align-items: center;
        transition: right 0.03s linear;
    }

    .name {
        width: 120px;
        text-align: right;
        margin-right: 10px;
        font-size: 17px;
        white-space: nowrap;
    }

    .body {
        width: 80px;
        height: 34px;
        border-radius: 18px;
        position: relative;
    }

    .fringe {
        position: absolute;
        top: -7px;
        left: 10px;
        width: 26px;
        height: 12px;
        border-radius: 12px;
    }

    /* Horse colors */
    .p1 .body { background: #e6c8a0; }
    .p1 .fringe { background: #3e2723; }

    .p2 .body { background: #4e342e; }
    .p2 .fringe { background: #ffffff; }

    .gold .body { background: #dcdcdc; }
    .gold .fringe { background: #9e9e9e; }

    .safe .body { background: #6d4c41; }
    .safe .fringe { background: #3e2723; }

    button {
        margin: 16px;
        padding: 12px 28px;
        font-size: 18px;
        background: #ffeb3b;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
    }

    button:hover {
        background: #fdd835;
    }
</style>
</head>

<body>

<h1>競馬</h1>

<div id="track">
    <div id="finish"></div>

    <div class="horse p1" style="top: 40px;">
        <div class="name">プレイヤー1</div>
        <div class="body"><div class="fringe"></div></div>
    </div>

    <div class="horse p2" style="top: 140px;">
        <div class="name">プレイヤー2</div>
        <div class="body"><div class="fringe"></div></div>
    </div>

    <div class="horse gold" style="top: 240px;">
        <div class="name">ゴールドシップ</div>
        <div class="body"><div class="fringe"></div></div>
    </div>

    <div class="horse safe" style="top: 340px;">
        <div class="name">安全走</div>
        <div class="body"><div class="fringe"></div></div>
    </div>
</div>

<button onclick="startRace()">レース開始</button>

<script>
let racing = false;
const horses = document.querySelectorAll(".horse");

function speak(text) {
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = "ja-JP";
    speechSynthesis.cancel();
    speechSynthesis.speak(msg);
}

function startRace() {
    if (racing) return;
    racing = true;

    horses.forEach(h => h.style.right = "40px");

    speak("レースを開始します");

    const speeds = Array.from(horses).map(() => Math.random() * 2.5 + 1);

    const raceLoop = setInterval(() => {
        horses.forEach((horse, i) => {
            let pos = parseFloat(horse.style.right);
            pos += speeds[i];
            horse.style.right = pos + "px";

            if (pos > window.innerWidth - 160) {
                clearInterval(raceLoop);
                racing = false;

                const winner = horse.querySelector(".name").innerText;
                speak(winner + " が 勝ちました");
            }
        });
    }, 30);
}
</script>

</body>
</html>
